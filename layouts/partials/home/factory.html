{{ $factory := .Params.factory }}
{{ if $factory.enable }}
<section class="factory" aria-labelledby="factory-title">
  <div class="container container--wide">
    <div class="factory__header">
      <h2 class="factory__title" id="factory-title">{{ $factory.title }}</h2>
      {{ with $factory.description }}
      <div class="factory__description">{{ . | markdownify }}</div>
      {{ end }}
      {{ with $factory.highlights }}
      <ul class="factory__highlights" role="list">
        {{ range . }}
        <li class="factory__pill">{{ . }}</li>
        {{ end }}
      </ul>
      {{ end }}
    </div>
    <div class="factory__grid">
      {{ range $index, $item := $factory.items }}
      <article class="factory__item">
        <figure
          class="factory__media"
          tabindex="0"
          aria-labelledby="factory-item-{{ $index }}-title"
          aria-describedby="factory-item-{{ $index }}-content"
        >
          <div class="factory__card" role="presentation">
            <div class="factory__side factory__side--front">
              {{ partial "picture.html" (dict
                "ctx"   $
                "src"   $item.image
                "alt"   $item.title
                "class" "factory__image"
                "sizes" "(max-width: 576px) 100vw, (max-width: 1024px) 50vw, 25vw"
                "w"     (slice 320 480 640 768 896 1024)
                "lqip"  true
              ) }}
              <div class="factory__front-overlay" aria-hidden="true">
                <h3 class="factory__item-title">{{ $item.title }}</h3>
                <p class="factory__hint">{{ i18n "hover_to_reveal" }}</p>
              </div>
            </div>
            <figcaption class="factory__side factory__side--back">
              <div class="factory__content">
                <h3 class="factory__item-title" id="factory-item-{{ $index }}-title">{{ $item.title }}</h3>
                <p class="factory__item-text" id="factory-item-{{ $index }}-content">{{ $item.content }}</p>
              </div>
            </figcaption>
          </div>
        </figure>
      </article>
      {{ end }}
    </div>
  </div>
</section>
{{ end }}
