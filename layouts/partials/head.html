{{- /* Hugo Pipes: SCSS -> CSS; production: minify + fingerprint (+SRI) */ -}}
{{- $style := resources.Get "scss/main.scss" | toCSS -}}
{{- if hugo.IsProduction -}}
  {{- $style = $style | minify | fingerprint -}}
{{- end -}}
<link rel="stylesheet" href="{{ $style.RelPermalink }}"
{{- if and hugo.IsProduction $style.Data.Integrity -}} integrity="{{ $style.Data.Integrity }}" crossorigin="anonymous"{{- end -}}>

{{- /* Page metadata */ -}}
{{- $title := .Site.Title -}}
{{- if not .IsHome -}}
  {{- with .Title -}}
    {{- $title = printf "%s | %s" . $.Site.Title -}}
  {{- end -}}
{{- end -}}

{{- $description := (.Description | default .Site.Params.description) | plainify | htmlEscape -}}

{{- $image := "" -}}
{{- with .Params.images -}}
  {{- $image = (index . 0) | absURL -}}
{{- else -}}
  {{- with .Site.Params.default_image -}}
    {{- $image = . | absURL -}}
  {{- end -}}
{{- end -}}

{{- $robots := .Params.robots | default "index, follow" -}}

<title>{{ $title }}</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="{{ $description }}">
<meta name="author" content="{{ .Site.Params.company_name | default .Site.Title }}">
<meta name="robots" content="{{ $robots }}">

<link rel="canonical" href="{{ .Permalink }}">

{{- /* RSS (optional; keep if you publish articles/news) */ -}}
<link rel="alternate" type="application/rss+xml" title="{{ .Site.Title }} RSS" href="{{ "index.xml" | relLangURL }}">

{{- /* hreflang */ -}}
<link rel="alternate" hreflang="x-default" href="{{ .Site.BaseURL }}">
{{- range .AllTranslations -}}
<link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
{{- end -}}

{{- /* Open Graph */ -}}
<meta property="og:title" content="{{ .Title | default .Site.Title | plainify | htmlEscape }}">
<meta property="og:description" content="{{ $description }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
<meta property="og:site_name" content="{{ .Site.Title }}">
<meta property="og:locale" content="{{ .Site.Language.Lang }}">
{{- if $image -}}
<meta property="og:image" content="{{ $image }}">
<meta property="og:image:alt" content="{{ .Title | default .Site.Title | plainify | htmlEscape }}">
{{- end -}}

{{- /* Twitter Card (optional; harmless to keep) */ -}}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ .Title | default .Site.Title | plainify | htmlEscape }}">
<meta name="twitter:description" content="{{ $description }}">
{{- if $image -}}
<meta name="twitter:image" content="{{ $image }}">
{{- end -}}
